# CPU
## Источники событий
![image](https://github.com/user-attachments/assets/a438faca-2506-45e8-97c3-2a966c4c46be)
А также попадания в кеш (PMC) - можно связать с вызовом приложения.<br>
А также трассировка стека, нахождение что привело к событию
## Оверхед
При трассировке событий планировщика эффективность обретает особую важность,
так как некоторые события планировщика, например переключение контекста, могут происходить миллионы раз в секунду. В некоторых случаях трассировка планировщика увеличивает нагруз-
ку на систему более чем на 10%.

Трассировка планировщика с помощью BPF применяется для краткосрочного
и специализированного анализа, при этом нужно понимать, что она сопряжена
с оверхедом.

Инструментация редких событий, например запуска процессов и миграции потоков (происходящих не чаще
чем тысячу раз в секунду), порождает незначительный оверхед. Профилирование
(выборка по времени) тоже позволяет ограничить оверхед уменьшением частоты
выборки до незначительных пропорций.
## Стратегия
1. Прежде чем тратить время на инструменты анализа, убедитесь, что рабочая
нагрузка на CPU запущена. Проверьте загрузку CPU системы (например,
с помощью mpstat(1)) и убедитесь, что все CPU включены (иногда по какой-то
причине некоторые могут быть отключены).

2. Убедитесь, что рабочая нагрузка имеет вычислительный характер

 - a) определите наибольшую загрузку CPU в системе или на одном процессоре
(например, с помощью mpstat(1));

- b) определите наибольшую задержку в очереди на выполнение (например,
с помощью runqlat(1) из BCC). Программные ограничения, например,
в контейнерах, могут искусственно ограничивать доступ процессов к CPU,
поэтому производительность вычислительного приложения может быть
низкой, даже когда система практически простаивает. Этот нелогичный
сценарий можно опознать, изучив задержку в очереди на выполнение.
